import { connectionOracle } from './connection/oracledb'

const usuariosDoc = [21114481300, 21082747233, 21118296248, 21193109926, 2700439627, 266830666, 21006233390, 231475198, 21144050075, 21112464726, 21090444607, 21112879600,
  294070693, 250983306, 21087784220, 229588498, 21118258673, 231467721, 238943942, 21116372914, 21221721145, 231791069, 253013915, 26331794, 238669111, 21112474505, 241937794, 21130946314,
  21112478475, 238668841, 231529715, 21118310206, 231481845, 21130587740, 21006232622, 21006337769, 231484705, 229434913, 238569844, 21112471406, 231446072, 231539809, 231481278, 266870084,
  238461907, 21130666452, 21060266351, 21058972422, 21094916753, 21112473177, 26343869, 231478901, 21112465495, 21112461635, 21118312100, 231479837, 21118310580, 231523454, 21112489378, 21118289312,
  21130646276, 2805013949, 21006596920, 231096304, 26332040, 238288504, 21151946844, 21112482421, 266827012, 238669793, 216820784, 266909227, 231480993, 234503770, 21118237270, 21112461901, 21112467207,
  21112470124, 214577238, 229940987, 229115925, 21118286495, 21005878322, 21118296707, 234673866, 231476856, 231471953, 21062333980, 231532232, 231529165, 231878200, 21111479936, 219247584, 2700360072,
  21193214501, 21059981058, 21064438965, 251785777, 21114480858, 237083194, 231945823, 21118299385, 21112464026, 210559873, 21125388185, 21006364690, 231526956, 231419864, 21006365032, 266740532,
  21118301543, 216450099, 234551003, 2700445401, 21087198736, 21006234663, 21118291404, 229974963, 21099708231, 21118285073, 231307215, 234674960, 238671176, 266959556, 214232375, 231940983, 231534623,
  266992413, 231483782, 21118292723, 21193260472, 234327309, 21089796669, 225363989, 231642278, 21144131949, 21088650250, 21118311390, 21120580061, 21063812752, 216745855, 231484986, 21112462179,
  21107088520, 21143879946, 231946481, 229583747, 266834422, 215373979, 21063817846, 266929649, 21112484604, 21112490833, 266702782, 21017234334, 21005978228, 267015849, 21110443849, 21112473541,
  24580298, 21112480747, 21112493001, 21096035851, 231713261, 21005831215, 21089907240, 234545068, 21112148630, 2700236823, 229940640, 246386162, 21112489265, 231472806, 266812473, 236065411, 21114952497,
  266955726, 21112469722, 294543054, 231426289, 242082761, 21118309688, 238553570, 21118298068, 2700316416, 266822684, 21111794501, 214675027, 21116372009, 21112474594, 238670925, 231477050, 21118291351,
  231986783, 21112475951, 21112479182, 21118293003, 21112483634, 21006017706, 21006233411, 240733005, 21114480401, 21143941075, 231525922, 238889593, 231449517, 21061764517, 21061438025, 231307182, 231470195,
  21114489357, 21118291378, 231483384, 21025761047, 231448561, 2700478374, 21112958126, 266861706, 21112459305, 21118297700, 21006235131, 21061806933, 21110362042, 21062276087, 21112484701, 231480004, 238681655,
  21118283211, 231485279, 231479210, 21112463964, 21088001876, 238561100, 229939992, 229974866, 21113781893, 21143990230, 26423377, 21193415019, 21115448082, 21030554222, 21045742894, 231858543, 21112481339]

const main = async () => {
  try {
    let pool = await connectionOracle();

    // Check if the connection was successful
    if (pool instanceof Error) throw pool
    let connection = await pool.getConnection();

    // connection ready to use
    const results = await connection.execute(
      `
        SELECT FECHAPAGO, SERIE, NUMERO, TOTALPREMIO, RETEFUENTE, LOGINCAJERO, PUNTO_VTA_PAGO, HORA 
        FROM premiospersonaproveedor@CONSULTAS
        WHERE 
          fechapago BETWEEN TO_DATE('01/10/2024','DD/MM/YYYY') AND TO_DATE('31/10/2024','DD/MM/YYYY')
        AND documentocajero IN (${usuariosDoc.join(',')})
      `
    );

    console.log(results.rows);

  } catch (error) {
    console.error(error);
  }
}

main();
